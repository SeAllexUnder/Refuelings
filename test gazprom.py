import json

import requests as r
import hashlib

token = '74gbmqhv8w816vm96982m5mnoq1fxod9uvuofjxwvpcrpn68o5'
baseURL = 'http://194.58.104.213/lk'
contract_code = 'DT17100278'
cards = {}
transactions = []

# Список топливных карт
URL = f'{baseURL}/api/api_v2.php'
# action = 'cards'
# params = {'action': action,
#           'key': '{key}',
#           'cont': contract_code}
headers = {'apikey': token,
           'Content-Type': 'application/json'}
# responce = r.post(url=URL, headers=headers, data=json.dumps(params))
# for card in responce.json()['result']:
#     if card['stat'] == 'Активна':
#         cards[card['lognb']] = card['user'].split(' ')[0]

cards = {'1007800000101618593': '', '1007800000101618594': '', '1007800000101618595': '', '1007800000101618596': '', '1007800000101618597': '', '1007800000101618598': '', '1007800000101618599': '', '1007800000101618600': '', '1007800000101618601': '', '1007800000101618602': 'Е581НУ198', '1007800000101618603': '', '1007800000101618604': '', '1007800000101618605': 'О583ОТ198', '1007800000101618606': '', '1007800000101618607': '', '1007800000101618608': '', '1007800000101618609': '', '1007800000101618610': '', '1007800000101618611': '', '1007800000101618612': '', '1007800000101618613': 'В519РХ198', '1007800000101618614': '', '1007800000101618615': 'Е606НУ198', '1007800000101618616': 'О309ОВ198', '1007800000101618617': 'В483РХ198', '1007800000101618618': 'О810ВВ198', '1007800000101618619': 'О586НВ198', '1007800000101618620': 'А624АМ797', '1007800000101618621': 'О577КР198', '1007800000101618622': '', '1007800000101618623': '', '1007800000101618624': '', '1007800000101618625': '', '1007800000101618626': '', '1007800000101618627': '', '1007800000101618628': '', '1007800000101618629': '', '1007800000101618630': '', '1007800000101618631': '', '1007800000101618632': '', '1007800000101618633': '', '1007800000101618634': '', '1007800000101618635': '', '1007800000101618636': '', '1007800000101618637': 'О577ЕН198', '1007800000101618638': 'О403ВЕ198', '1007800000101618639': 'О581МС198', '1007800000101618640': 'О551МА198', '1007800000101618641': 'О465КЕ198', '1007800000101618642': 'Е284ВО198', '1007800000101618643': '', '1007800000101618644': '', '1007800000101618645': 'О585МУ198', '1007800000101618646': 'О577НМ198', '1007800000101618647': 'О855АУ198', '1007800000101618648': 'В711РУ198', '1007800000101618649': 'О403КН198', '1007800000101618650': 'О403АС198', '1007800000101618651': '', '1007800000101618652': '', '1007800000101618653': '', '1007800000101618654': 'О409НН198', '1007800000101618655': 'О810АУ198', '1007800000101618656': 'О550ЕН198', '1007800000101618657': 'О551КН198', '1007800000101618658': 'О551ВЕ198', '1007800000101618659': 'Е392ВО198', '1007800000101618660': 'А266ХВ716', '1007800000101618661': 'Е410ВО198', '1007800000101618662': 'О465ОЕ198', '1007800000101618663': 'О402ОТ198', '1007800000101618664': 'О549КР198', '1007800000101618665': 'В723АТ797', '1007800000101618666': 'О550НВ198', '1007800000101618667': '', '1007800000101618668': '', '1007800000101618669': '', '1007800000101618670': '', '1007800000101618671': '', '1007800000101618672': '', '1007800000101618673': 'Е671НУ198', '1007800000101618674': 'Е612НУ198', '1007800000101618675': '', '1007800000101618676': '', '1007800000101618677': 'Р819АО797', '1007800000101618678': '', '1007800000101618679': '', '1007800000101618680': '', '1007800000101618681': '', '1007800000101618682': '', '1007800000101618683': '', '1007800000101618684': '', '1007800000101618685': '', '1007800000101618686': '', '1007800000101618687': '', '1007800000101618688': '', '1007800000101618689': '', '1007800000101618694': 'О551МУ198', '1007800000101618695': 'Е390ВО198', '1007800000101618696': 'О755АР198', '1007800000101618697': 'О218РВ198', '1007800000101618698': 'А605АС797', '1007800000101618699': 'О551КН198', '1007800000101618700': 'В192СТ198', '1007800000101618701': 'О410МО198', '1007800000101618702': 'О576МН198', '1007800000101618703': 'О551КМ198', '1007800000101618704': 'О454НТ198', '1007800000101618705': 'Е329ВО198', '1007800000101618706': 'Е255ВО198', '1007800000101618707': 'О815ВУ198', '1007800000101618708': 'О582МН198', '1007800000101618709': '', '1007800000101618710': 'О585НМ198', '1007800000101618711': 'О454ОА198', '1007800000101618712': 'О583НВ198', '1007800000101618713': 'О465МУ198', '1007800000101618714': '', '1007800000101618715': '', '1007800000101618716': '', '1007800000101618717': '', '1007800000101618718': '', '1007800000101618719': '', '1007800000101618720': 'О403НН198', '1007800000101618721': '', '1007800000101618722': '', '1007800000101618723': '', '1007800000101618724': '', '1007800000101618725': '', '1007800000101618726': '', '1007800000101618727': '', '1007800000101618728': '', '1007800000101618729': '', '1007800000101618730': '', '1007800000101618731': '', '1007800000101618732': 'О577МС198', '1007800000101618733': 'О585нк198', '1007800000101618734': 'М577КМ797', '1007800000101618735': 'В827АЕ797', '1007800000101618736': 'О411ЕТ198', '1007800000101618737': 'Е345ВО198', '1007800000101618738': 'В597РХ198', '1007800000101618739': 'В770АЕ797', '1007800000101618740': '', '1007800000101618741': '', '1007800000101618742': 'В604РО716', '1007800000101618743': 'О576ОА198', '1007800000101618744': 'Е612НУ198', '1007800000101618745': 'О411ВС198', '1007800000101618746': 'О453ОУ198', '1007800000101618747': 'О551МК198', '1007800000101618748': 'О218ОВ198', '1007800000101618749': '', '1007800000101618750': '', '1007800000101618751': '', '1007800000101618752': '', '1007800000101618753': '', '1007800000101618754': '', '1007800000101618755': '', '1007800000101618756': ''}

# Транзакции за период
date_From = '2023-01-24'
date_To = '2023-01-25'
action = 'opers'
params = {'action': action,
          'key': '{key}',
          'cont': contract_code,
          'dtemin': date_From,
          'dtemax': date_To}
responce = r.post(url=URL, headers=headers, data=json.dumps(params))
print(responce.json())
if responce.json()['vidgsm'] != 'tovar':
    # Сохраняем транзакцию
    pass
